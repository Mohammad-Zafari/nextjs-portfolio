===========================================
FIXING CONTACT FORM 500 ERROR ON VERCEL
===========================================

The contact form is failing because environment variables are not configured in Vercel.

IMMEDIATE FIX - REQUIRED STEPS:
================================

1. Go to your Vercel Dashboard:
   https://vercel.com/dashboard

2. Select your project: nextjs-portfolio-beta-red

3. Go to Settings > Environment Variables

4. Add these REQUIRED variables:
   
   Variable Name: NEXT_PUBLIC_SUPABASE_URL
   Value: [Your Supabase Project URL]
   
   Variable Name: NEXT_PUBLIC_SUPABASE_ANON_KEY
   Value: [Your Supabase Anon Key]
   
   Variable Name: SUPABASE_SERVICE_ROLE_KEY
   Value: [Your Supabase Service Role Key]

5. IMPORTANT: After adding variables, you MUST redeploy:
   - Go to Deployments tab
   - Click the three dots (...) on the latest deployment
   - Click "Redeploy"
   - OR push a new commit to trigger automatic deployment

WHERE TO GET SUPABASE CREDENTIALS:
===================================

1. Go to: https://supabase.com/dashboard
2. Select your project (or create one if you don't have it)
3. Go to: Settings > API
4. You'll see:
   - Project URL → Copy this to NEXT_PUBLIC_SUPABASE_URL
   - anon public key → Copy this to NEXT_PUBLIC_SUPABASE_ANON_KEY
   - service_role key → Copy this to SUPABASE_SERVICE_ROLE_KEY

SETUP SUPABASE DATABASE:
========================

If you haven't set up the database yet:

1. In Supabase Dashboard, go to SQL Editor
2. Run the SQL from: supabase/schema.sql
3. Run the SQL from: supabase/enhancement.sql

This creates the contact_messages table to store form submissions.

OPTIONAL - EMAIL NOTIFICATIONS:
================================

To receive email notifications when someone submits the contact form:

1. Sign up at: https://resend.com
2. Get your API key from: https://resend.com/api-keys
3. Add these variables in Vercel:
   
   Variable Name: RESEND_API_KEY
   Value: [Your Resend API Key]
   
   Variable Name: RESEND_FROM_EMAIL
   Value: onboarding@resend.dev
   
   Variable Name: CONTACT_EMAIL
   Value: my.mohammad.zafari@gmail.com

Note: Email is optional. The contact form will work without it - 
messages will still be saved to Supabase database.

TESTING AFTER FIX:
==================

1. After redeploying with environment variables
2. Go to: https://nextjs-portfolio-beta-red.vercel.app/contact
3. Fill out and submit the form
4. You should see "Message sent!" success message
5. Check your Supabase database to verify the message was saved

TROUBLESHOOTING:
================

If it still doesn't work:

1. Check Vercel Function Logs:
   - Go to your Vercel project
   - Click on a deployment
   - Go to "Functions" tab
   - Look for error messages

2. Verify environment variables are set:
   - Go to Settings > Environment Variables
   - Make sure all variables are there
   - Make sure there are no typos

3. Make sure you redeployed after adding variables:
   - Environment variables only take effect after redeployment

4. Test locally first:
   - Create .env.local with the same variables
   - Run: npm run dev
   - Test at http://localhost:3000/contact

CURRENT CODE CHANGES MADE:
==========================

1. Added better error logging in contact form action
2. Created icon.tsx for favicon (fixes 404 error)
3. Updated error messages to show your email as fallback
4. Created .env.example with all required variables
5. Updated README with deployment instructions

FILES CHANGED:
==============
- src/app/contact/actions.ts (better error handling)
- src/app/icon.tsx (new - fixes favicon 404)
- .env.example (new - documents required variables)
- README.md (updated with deployment guide)

SUMMARY:
========

The main issue is missing environment variables in Vercel.
Once you add the Supabase credentials and redeploy, 
the contact form will work perfectly!

Questions? Contact me at: my.mohammad.zafari@gmail.com
